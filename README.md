# Zinnsoldat Bookmarklet

Used to inject the bot client into your browser.

## Building

You can convert the script into a bookmarklet manually at https://www.taosdev.com/bookmarklet-devkit/.

<a href="javascript:(function()%7B(async%20()%20%3D%3E%20%7B%0A%20%20%20%20%2F%2F%20Check%20for%20marker%3B%20only%20load%20the%20script%20once!%0A%20%20%20%20if%20(document.head.querySelector('meta%5Bname%3D%22zinnsoldat%22%5D'))%20%7B%0A%20%20%20%20%20%20%20%20console.warn('Script%20already%20loaded!')%3B%0A%20%20%20%20%20%20%20%20return%3B%0A%20%20%20%20%7D%0A%20%20%20%20const%20marker%20%3D%20document.createElement('meta')%3B%0A%20%20%20%20marker.setAttribute('name'%2C%20'zinnsoldat')%3B%0A%20%20%20%20document.head.appendChild(marker)%3B%0A%0A%20%20%20%20const%20zs_version%20%3D%201%3B%0A%20%20%20%20const%20zs_versionInfo%20%3D%20document.createElement('span')%3B%0A%20%20%20%20zs_versionInfo.innerText%20%3D%20%60Zinnsoldat%20v%24%7Bzs_version%7D%60%3B%0A%20%20%20%20zs_versionInfo.style%20%3D%20'position%3A%20fixed%3B%20bottom%3A%2030px%3B%20left%3A%2030px%3B%20z-index%3A%20100%3B%20font-weight%3A%20600%3B%20color%3A%20white%3B%20font-size%3A%201.2em%3B'%3B%0A%20%20%20%20document.body.appendChild(zs_versionInfo)%3B%0A%0A%20%20%20%20%2F%2F%20Load%20Toastify%0A%20%20%20%20await%20new%20Promise((resolve%2C%20reject)%20%3D%3E%20%7B%0A%20%20%20%20%20%20%20%20var%20toastifyStyle%20%3D%20document.createElement('link')%3B%0A%20%20%20%20%20%20%20%20toastifyStyle.type%20%3D%20%22text%2Fcss%22%3B%0A%20%20%20%20%20%20%20%20toastifyStyle.rel%20%3D%20%22stylesheet%22%3B%0A%20%20%20%20%20%20%20%20toastifyStyle.media%20%3D%20%22screen%22%3B%0A%20%20%20%20%20%20%20%20toastifyStyle.href%20%3D%20'https%3A%2F%2Fcdn.jsdelivr.net%2Fnpm%2Ftoastify-js%2Fsrc%2Ftoastify.min.css'%3B%0A%20%20%20%20%20%20%20%20document.head.appendChild(toastifyStyle)%3B%0A%20%20%20%20%20%20%20%20var%20toastifyScript%20%3D%20document.createElement('script')%3B%0A%20%20%20%20%20%20%20%20toastifyScript.setAttribute('src'%2C%20'https%3A%2F%2Fcdn.jsdelivr.net%2Fnpm%2Ftoastify-js')%3B%0A%20%20%20%20%20%20%20%20toastifyScript.setAttribute('async'%2C%20false)%3B%0A%20%20%20%20%20%20%20%20document.body.appendChild(toastifyScript)%3B%0A%20%20%20%20%20%20%20%20toastifyScript.addEventListener('load'%2C%20(ev)%20%3D%3E%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20resolve(%7B%20status%3A%20true%20%7D)%3B%0A%20%20%20%20%20%20%20%20%7D)%3B%0A%20%20%20%20%20%20%20%20toastifyScript.addEventListener('error'%2C%20(ev)%20%3D%3E%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20reject(%7B%20status%3A%20false%2C%20message%3A%20%60Failed%20to%20load%20the%20toastify%60%20%7D)%3B%0A%20%20%20%20%20%20%20%20%7D)%3B%0A%20%20%20%20%7D)%3B%0A%20%20%20%20const%20zs_info%20%3D%20(msg)%20%3D%3E%20%7B%0A%20%20%20%20%20%20%20%20Toastify(%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20text%3A%20msg%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20duration%3A%205000%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20gravity%3A%20%22bottom%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20position%3A%20%22right%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20stopOnFocus%3A%20true%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20style%3A%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20background%3A%20'%23383838'%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20color%3A%20'%23fff'%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20border%3A%20'3px%20solid%20%23000000'%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20'box-shadow'%3A%20'8px%208px%200px%20rgba(0%2C%200%2C%200%2C%200.75)'%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20'font-family'%3A%20%60-apple-system%2CBlinkMacSystemFont%2C'Segoe%20UI'%2CRoboto%2C'Helvetica%20Neue'%2CArial%2C'Apple%20Color%20Emoji'%2C'Segoe%20UI%20Emoji'%2C'Segoe%20UI%20Symbol'%2Csans-serif%3B%60%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20'font-weight'%3A%20600%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20%7D).showToast()%3B%0A%20%20%20%20%7D%0A%20%20%20%20const%20zs_warn%20%3D%20(msg)%20%3D%3E%20%7B%0A%20%20%20%20%20%20%20%20Toastify(%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20text%3A%20msg%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20duration%3A%205000%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20gravity%3A%20%22bottom%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20position%3A%20%22right%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20stopOnFocus%3A%20true%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20style%3A%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20background%3A%20'%23FFA800'%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20color%3A%20'%23000'%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20border%3A%20'3px%20solid%20%23000000'%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20'box-shadow'%3A%20'8px%208px%200px%20rgba(0%2C%200%2C%200%2C%200.75)'%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20'font-family'%3A%20%60-apple-system%2CBlinkMacSystemFont%2C'Segoe%20UI'%2CRoboto%2C'Helvetica%20Neue'%2CArial%2C'Apple%20Color%20Emoji'%2C'Segoe%20UI%20Emoji'%2C'Segoe%20UI%20Symbol'%2Csans-serif%3B%60%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20'font-weight'%3A%20600%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20%7D).showToast()%3B%0A%20%20%20%20%7D%0A%20%20%20%20const%20zs_error%20%3D%20(msg)%20%3D%3E%20%7B%0A%20%20%20%20%20%20%20%20Toastify(%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20text%3A%20msg%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20duration%3A%205000%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20gravity%3A%20%22bottom%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20position%3A%20%22right%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20stopOnFocus%3A%20true%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20style%3A%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20background%3A%20'%23d93a00'%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20color%3A%20'%23fff'%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20border%3A%20'3px%20solid%20%23000000'%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20'box-shadow'%3A%20'8px%208px%200px%20rgba(0%2C%200%2C%200%2C%200.75)'%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20'font-family'%3A%20%60-apple-system%2CBlinkMacSystemFont%2C'Segoe%20UI'%2CRoboto%2C'Helvetica%20Neue'%2CArial%2C'Apple%20Color%20Emoji'%2C'Segoe%20UI%20Emoji'%2C'Segoe%20UI%20Symbol'%2Csans-serif%3B%60%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20'font-weight'%3A%20600%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20%7D).showToast()%3B%0A%20%20%20%20%7D%0A%20%20%20%20const%20zs_success%20%3D%20(msg)%20%3D%3E%20%7B%0A%20%20%20%20%20%20%20%20Toastify(%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20text%3A%20msg%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20duration%3A%205000%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20gravity%3A%20%22bottom%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20position%3A%20%22right%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20stopOnFocus%3A%20true%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20style%3A%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20background%3A%20'%2300A368'%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20color%3A%20'%23fff'%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20border%3A%20'3px%20solid%20%23000000'%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20'box-shadow'%3A%20'8px%208px%200px%20rgba(0%2C%200%2C%200%2C%200.75)'%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20'font-family'%3A%20%60-apple-system%2CBlinkMacSystemFont%2C'Segoe%20UI'%2CRoboto%2C'Helvetica%20Neue'%2CArial%2C'Apple%20Color%20Emoji'%2C'Segoe%20UI%20Emoji'%2C'Segoe%20UI%20Symbol'%2Csans-serif%3B%60%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20'font-weight'%3A%20600%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20%7D).showToast()%3B%0A%20%20%20%20%7D%0A%20%20%20%20const%20zs_updateNotification%20%3D%20()%20%3D%3E%20%7B%0A%20%20%20%20%20%20%20%20Toastify(%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20text%3A%20'Neue%20Version%20auf%20https%3A%2F%2Fplace.army%2F%20verf%C3%BCgbar!'%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20destination%3A%20'https%3A%2F%2Fplace.army%2F'%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20duration%3A%20-1%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20gravity%3A%20%22bottom%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20position%3A%20%22right%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20style%3A%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20background%3A%20'%233690EA'%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20color%3A%20'%23fff'%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20border%3A%20'3px%20solid%20%23000000'%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20'box-shadow'%3A%20'8px%208px%200px%20rgba(0%2C%200%2C%200%2C%200.75)'%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20'font-family'%3A%20%60-apple-system%2CBlinkMacSystemFont%2C'Segoe%20UI'%2CRoboto%2C'Helvetica%20Neue'%2CArial%2C'Apple%20Color%20Emoji'%2C'Segoe%20UI%20Emoji'%2C'Segoe%20UI%20Symbol'%2Csans-serif%3B%60%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20'font-weight'%3A%20600%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20%7D).showToast()%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20zs_info('Einer%20von%20uns!')%3B%0A%0A%20%20%20%20%2F%2F%20Retrieve%20access%20token%0A%20%20%20%20const%20zs_getAccessToken%20%3D%20async%20()%20%3D%3E%20%7B%0A%20%20%20%20%20%20%20%20const%20usingOldReddit%20%3D%20window.location.href.includes('new.reddit.com')%3B%0A%20%20%20%20%20%20%20%20const%20url%20%3D%20usingOldReddit%20%3F%20'https%3A%2F%2Fnew.reddit.com%2Fr%2Fplace%2F'%20%3A%20'https%3A%2F%2Fwww.reddit.com%2Fr%2Fplace%2F'%3B%0A%20%20%20%20%20%20%20%20const%20response%20%3D%20await%20fetch(url)%3B%0A%20%20%20%20%20%20%20%20const%20responseText%20%3D%20await%20response.text()%3B%0A%20%20%20%20%0A%20%20%20%20%20%20%20%20return%20responseText.match(%2F%22accessToken%22%3A%22(%5C%5C%22%7C%5B%5E%22%5D*)%22%2F)%5B1%5D%3B%0A%20%20%20%20%7D%0A%20%20%20%20zs_info('Erbitte%20Reddit%20um%20Zugriff...')%3B%0A%20%20%20%20let%20zs_accessToken%20%3D%20await%20zs_getAccessToken()%3B%0A%20%20%20%20zs_success('Zugriff%20gew%C3%A4hrt!')%3B%0A%0A%20%20%20%20const%20zs_getCanvasId%20%3D%20(x%2C%20y)%20%3D%3E%20%7B%0A%20%20%20%20%20%20%20%20if%20(y%20%3C%200)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%201%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20return%204%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20const%20zs_getCanvasX%20%3D%20(x%2C%20y)%20%3D%3E%20%7B%0A%20%20%20%20%20%20%20%20return%20x%20%2B%20500%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20const%20zs_getCanvasY%20%3D%20(x%2C%20y)%20%3D%3E%20%7B%0A%20%20%20%20%20%20%20%20return%20zs_getCanvasId(x%2C%20y)%20%3C%203%20%3F%20y%20%2B%201000%20%3A%20y%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20const%20zs_placePixel%20%3D%20async%20(x%2C%20y%2C%20color)%20%3D%3E%20%7B%0A%20%20%20%20%20%20%20%20console.log('Placed%20pixel%20at%20%25s%2C%20%25s%20in%20%25s'%2C%20x%2C%20y%2C%20color)%3B%0A%20%20%20%20%20%20%20%20const%20response%20%3D%20await%20fetch('https%3A%2F%2Fgql-realtime-2.reddit.com%2Fquery'%2C%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20method%3A%20'POST'%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20body%3A%20JSON.stringify(%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20'operationName'%3A%20'setPixel'%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20'variables'%3A%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20'input'%3A%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20'actionName'%3A%20'r%2Freplace%3Aset_pixel'%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20'PixelMessageData'%3A%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20'coordinate'%3A%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20'x'%3A%20zs_getCanvasX(x%2C%20y)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20'y'%3A%20zs_getCanvasY(x%2C%20y)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20'colorIndex'%3A%20color%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20'canvasIndex'%3A%20zs_getCanvasId(x%2C%20y)%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20'query'%3A%20%60mutation%20setPixel(%24input%3A%20ActInput!)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20act(input%3A%20%24input)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20data%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20...%20on%20BasicMessage%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20id%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20data%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20...%20on%20GetUserCooldownResponseMessageData%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20nextAvailablePixelTimestamp%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20__typename%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20...%20on%20SetPixelResponseMessageData%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20timestamp%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20__typename%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20__typename%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20__typename%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20__typename%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20__typename%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%60%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20headers%3A%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20'origin'%3A%20'https%3A%2F%2Fgarlic-bread.reddit.com'%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20'referer'%3A%20'https%3A%2F%2Fgarlic-bread.reddit.com%2F'%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20'apollographql-client-name'%3A%20'garlic-bread'%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20'Authorization'%3A%20%60Bearer%20%24%7Bzs_accessToken%7D%60%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20'Content-Type'%3A%20'application%2Fjson'%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D)%3B%0A%20%20%20%20%20%20%20%20const%20data%20%3D%20await%20response.json()%0A%20%20%20%20%20%20%20%20if%20(data.errors%20!%3D%3D%20undefined)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(data.errors%5B0%5D.message%20%3D%3D%3D%20'Ratelimited')%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20zs_warn('Du%20hast%20noch%20Abklingzeit!')%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20data.errors%5B0%5D.extensions%3F.nextAvailablePixelTs%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20console.error(data.errors)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20zs_error('Fehler%20beim%20Platzieren%20des%20Pixels')%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20null%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20zs_success(%60Pixel%20(%24%7Bx%7D%2C%20%24%7By%7D)%20platziert!%60)%3B%0A%20%20%20%20%20%20%20%20return%20data%3F.data%3F.act%3F.data%3F.%5B0%5D%3F.data%3F.nextAvailablePixelTimestamp%3B%0A%20%20%20%20%7D%0A%0A%0A%20%20%20%20let%20c2%3B%0A%20%20%20%20let%20tokens%20%3D%20%5B'PLACE_DE_RdODJlIhcKMPemKQDvHysWhVWVDbWZJfjPWtnQciOKQMYcNAQyOKxWaXPnXoGfepWDbwjWhHMlIFjhfrqgkwkuqfTRE'%5D%3B%20%2F%2F%20We%20only%20have%20one%20token%0A%0A%20%20%20%20let%20placeTimeout%3B%0A%20%20%20%20const%20zs_requestJob%20%3D%20()%20%3D%3E%20%7B%0A%20%20%20%20%20%20%20%20if%20(c2.readyState%20!%3D%3D%20c2.OPEN)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20zs_error('Verbindung%20zum%20%22Carpetbomber%22%20abgebrochen.%20Verbinde...')%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20zs_initCarpetbomberConnection()%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20c2.send(JSON.stringify(%7B%20type%3A%20%22RequestJobs%22%2C%20tokens%3A%20tokens%20%7D))%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20const%20zs_processJobResponse%20%3D%20(jobs)%20%3D%3E%20%7B%0A%20%20%20%20%20%20%20%20if%20(!jobs%20%7C%7C%20jobs%20%3D%3D%3D%20%7B%7D)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20zs_warn('Kein%20verf%C3%BCgbarer%20Auftrag.%20Versuche%20in%2060s%20erneut')%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20clearTimeout(placeTimeout)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20placeTimeout%20%3D%20setTimeout(()%20%3D%3E%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20zs_requestJob()%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%2C%2060000)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20let%20%5Btoken%2C%20%5Bjob%2C%20code%5D%5D%20%3D%20Object.entries(jobs)%5B0%5D%3B%0A%20%20%20%20%20%20%20%20if%20(!job)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20Check%20if%20ratelimited%20and%20schedule%20retry%0A%20%20%20%20%20%20%20%20%20%20%20%20const%20ratelimit%20%3D%20code%3F.Ratelimited%3F.until%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(ratelimit)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20clearTimeout(placeTimeout)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20placeTimeout%20%3D%20setTimeout(()%20%3D%3E%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20zs_requestJob()%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%2C%20Math.max(5000%2C%20Date.parse(ratelimit)%20%2B%201000%20-%20Date.now()))%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%2F%2F%20Other%20error.%20No%20jobs%20left%3F%0A%20%20%20%20%20%20%20%20%20%20%20%20zs_warn('Kein%20verf%C3%BCgbarer%20Auftrag.%20Versuche%20in%2020s%20erneut')%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20clearTimeout(placeTimeout)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20placeTimeout%20%3D%20setTimeout(()%20%3D%3E%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20zs_requestJob()%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%2C%2020000)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20return%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%2F%2F%20Execute%20job%0A%20%20%20%20%20%20%20%20console.log(JSON.stringify(job))%3B%0A%20%20%20%20%20%20%20%20zs_placePixel(job.x%2C%20job.y%2C%20job.color%20-%201).then((nextTry)%20%3D%3E%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20clearTimeout(placeTimeout)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20placeTimeout%20%3D%20setTimeout(()%20%3D%3E%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20zs_requestJob()%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%2C%20Math.max(5000%2C%20(nextTry%20%7C%7C%205*60*1000)%20-%20Date.now()))%3B%0A%20%20%20%20%20%20%20%20%7D)%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20const%20zs_initCarpetbomberConnection%20%3D%20()%20%3D%3E%20%7B%0A%20%20%20%20%20%20%20%20c2%20%3D%20new%20WebSocket(%22wss%3A%2F%2Fcarpetbomber.place.army%22)%3B%0A%0A%20%20%20%20%20%20%20%20c2.onopen%20%3D%20()%20%3D%3E%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20zs_info('Verbinde%20mit%20%22Carpetbomber%22...')%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20c2.send(JSON.stringify(%7B%20type%3A%20%22Handshake%22%2C%20version%3A%20zs_version%20%7D))%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20zs_requestJob()%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20c2.onerror%20%3D%20(error)%20%3D%3E%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20zs_error('Verbindung%20zum%20%22Carpetbomber%22%20fehlgeschlagen!%20Versuchen%20in%205s%20erneut')%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20console.error(error)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20setTimeout(zs_initCarpetbomberConnection%2C%205000)%3B%0A%20%20%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%20%20c2.onmessage%20%3D%20(event)%20%3D%3E%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20data%20%3D%20JSON.parse(event.data)%0A%20%20%20%20%20%20%20%20%20%20%20%20console.log('received%3A%20%25s'%2C%20JSON.stringify(data))%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20(data.type%20%3D%3D%3D%20'UpdateVersion')%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20zs_success('Verbindung%20aufgebaut!')%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20(data.version%20%3E%20zs_version)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20zs_updateNotification()%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%20else%20if%20(data.type%20%3D%3D%20%22Jobs%22)%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20zs_processJobResponse(data.jobs)%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20%0A%20%20%20%20zs_initCarpetbomberConnection()%3B%0A%7D)()%3B%7D)()%3B">Zinnsoldat v0.1</a>
